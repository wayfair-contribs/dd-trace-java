

final passEnvKey = "PASS_ENV"
def passEnv = [
  'HOME',
  'PATH',
  'PWD',
  'CI',
  'DOCKER_HOST',
  'DOCKER_TLS_VERIFY',
  'DOCKER_CERT_PATH',
  'TESTCONTAINERS_HOST_OVERRIDE',
  'TESTCONTAINERS_RYUK_DISABLED',
]
def customPassEnv = System.getenv(passEnvKey)
if (customPassEnv != null && !customPassEnv.trim().isEmpty()) {
  passEnv += ystem.getenv(passEnvKey).split(",").collect { it.trim() }
}

tasks.withType(Test).configureEach {
  System.getenv().each { key, value ->
    if (!passEnv.contains(key)) {
      environment.remove(key)
    }
  }
}
